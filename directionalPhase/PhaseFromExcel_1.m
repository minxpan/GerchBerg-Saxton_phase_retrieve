clc
close all
clear all
%% A letter map
A = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0;0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

%% A map 40 by 40

A40 = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

%% B letter map
B = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

%% C letter map
C = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0;0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0;0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

codes = [1,1,1,2,1,1,1,2,1,1,1,1,1,1,2,1,2,1,1,2;3,2,4,2,3,2,4,2,3,2,4,4,4,4,2,3,1,3,2,4;3,2,3,2,3,2,3,1,3,1,1,1,2,3,2,3,4,4,1,2;3,2,3,2,3,4,3,4,2,4,4,4,2,3,2,1,2,3,2,4;3,2,3,1,1,1,1,3,1,2,1,3,2,3,2,3,2,3,1,2;3,2,3,2,4,4,4,2,4,2,3,4,2,3,2,3,2,3,0,2;3,2,3,2,1,2,3,2,3,2,1,3,2,3,2,3,2,3,4,2;3,2,3,2,3,2,3,2,3,2,3,4,4,3,2,3,1,1,3,2;3,2,3,2,3,2,3,2,3,1,1,1,2,3,2,3,2,4,2,4;3,2,3,2,3,2,3,4,3,4,2,4,2,3,2,3,2,3,1,2;3,2,3,2,3,1,2,1,2,3,4,3,4,3,2,3,2,3,2,4;3,2,3,2,3,4,2,3,1,1,1,2,1,3,2,3,4,3,1,2;3,2,3,2,1,3,2,3,2,4,4,2,3,4,1,1,1,3,2,4;3,2,3,2,3,2,4,3,1,2,3,2,1,3,2,4,2,4,1,2;3,2,3,2,3,1,2,3,2,4,3,2,3,4,4,3,4,3,4,2;3,2,3,2,3,4,2,3,1,2,3,2,1,1,1,1,1,2,3,2;3,2,3,1,1,3,2,3,2,4,3,2,3,4,4,4,4,2,3,2;3,2,3,2,4,4,4,3,1,2,3,1,1,1,1,1,3,2,3,2;3,2,3,1,1,1,2,3,2,4,3,4,4,4,4,4,4,4,3,2;3,2,3,4,2,4,2,3,1,1,1,1,1,1,1,1,1,1,3,2;3,4,0,3,4,3,4,3,4,4,4,4,4,4,4,4,4,4,4,4];

codes = [1,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,0;3,2,4,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,2;3,1,2,3,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2;3,2,4,1,3,2,3,4,3,4,3,4,3,4,3,4,3,4,3,4;3,1,2,3,4,1,2,1,2,1,2,1,2,1,2,1,2,1,2,0;3,2,4,1,3,2,4,3,1,3,1,3,1,3,1,3,1,3,1,2;3,1,2,3,4,1,2,3,4,2,4,2,4,2,4,2,4,2,4,2;3,2,4,1,3,2,4,1,3,2,3,4,3,4,3,4,3,4,3,4;3,1,2,3,4,1,2,3,4,2,1,2,1,2,1,2,1,2,1,2;3,2,4,1,3,2,4,1,3,1,3,1,3,1,3,1,3,1,3,2;3,1,2,3,4,1,2,3,4,2,4,2,4,2,4,2,4,2,4,2;3,2,4,1,3,2,4,1,3,2,3,4,3,4,3,4,3,4,3,4;3,1,2,3,4,1,2,3,4,2,1,2,1,2,1,2,1,2,1,2;3,2,4,1,3,2,4,1,3,1,3,1,3,1,3,1,3,1,3,2;3,1,2,3,4,1,2,3,4,2,4,2,4,2,4,2,4,2,4,2;3,2,4,1,3,2,4,1,3,2,3,4,3,4,3,4,3,4,3,4;3,1,2,3,4,1,2,3,4,2,1,2,1,2,1,2,1,2,1,2;3,2,4,1,3,2,4,1,3,1,3,1,3,1,3,1,3,1,3,2;3,1,2,3,4,1,2,3,4,2,4,2,4,2,4,2,4,2,4,2;3,4,1,1,3,0,1,1,3,2,3,4,3,4,3,4,3,4,3,4;0,3,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0];

codes = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4];

codes = [1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2;3,2,4,4,2,4,2,3,4,2,4,4,4,2,4,2,4,4,4,2,4,2,4,4,4,2,4,2,4,4,4,2,4,2,4,4,4,2,4,2;3,1,2,3,2,3,2,1,3,1,1,2,3,4,3,1,1,2,3,4,3,1,1,2,3,4,3,1,1,2,3,4,3,1,1,2,3,4,3,2;3,2,4,3,4,3,2,3,2,4,4,4,1,1,3,2,4,4,1,2,3,4,4,4,1,1,3,2,4,4,1,2,3,4,4,4,1,1,3,2;3,1,1,1,2,3,2,3,2,1,1,1,3,2,4,1,1,1,3,1,2,1,1,1,3,2,4,1,1,1,3,1,2,1,1,1,3,2,4,2;3,2,4,4,4,3,4,3,2,3,4,4,4,4,3,2,4,4,4,4,4,3,4,4,4,4,3,2,4,4,4,4,4,3,4,4,4,4,3,2;3,1,1,1,1,1,2,3,2,1,2,1,1,2,3,2,1,1,1,1,2,1,2,1,1,2,3,2,1,1,1,1,2,1,1,1,2,1,3,2;3,2,4,4,2,4,2,3,2,3,2,3,2,4,3,2,3,4,4,2,4,3,2,3,2,4,3,2,3,4,4,2,4,3,2,4,4,3,4,2;3,1,2,3,2,3,2,3,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,1,1,1,3,2;3,2,4,3,4,3,2,3,2,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,4,4,2;3,1,1,1,2,3,2,3,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,2,3,2;3,2,4,4,4,3,4,3,2,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,3,2;3,1,1,1,1,1,2,3,2,1,2,1,1,2,3,2,1,1,1,1,2,1,2,1,1,2,3,2,1,1,1,1,2,1,1,1,2,1,3,2;3,2,4,4,2,4,2,3,2,3,2,3,2,4,3,2,3,4,4,2,4,3,2,3,2,4,3,2,3,4,4,2,4,3,2,4,4,3,4,2;3,1,2,3,2,3,2,3,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,1,1,1,3,2;3,2,4,3,4,3,2,3,2,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,4,4,2;3,1,1,1,2,3,2,3,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,2,3,2;3,2,4,4,4,3,4,3,2,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,3,2;3,1,1,1,1,1,2,3,2,1,2,1,1,2,3,2,1,1,1,1,2,1,2,1,1,2,3,2,1,1,1,1,2,1,1,1,2,1,3,2;3,2,4,4,2,4,2,3,2,3,2,3,2,4,3,2,3,4,4,2,4,3,2,3,2,4,3,2,3,4,4,2,4,3,2,4,4,3,4,2;3,1,2,3,2,3,2,3,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,1,1,1,3,2;3,2,4,3,4,3,2,3,2,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,4,4,2;3,1,1,1,2,3,2,3,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,2,3,2;3,2,4,4,4,3,4,3,2,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,3,2;3,1,1,1,1,1,2,3,2,1,2,1,1,2,3,2,1,1,1,1,2,1,2,1,1,2,3,2,1,1,1,1,2,1,1,1,2,1,3,2;3,2,4,4,2,4,2,3,2,3,2,3,2,4,3,2,3,4,4,2,4,3,2,3,2,4,3,2,3,4,4,2,4,3,2,4,4,3,4,2;3,1,2,3,2,3,2,3,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,1,1,1,3,2;3,2,4,3,4,3,2,3,2,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,4,4,2;3,1,1,1,2,3,2,3,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,2,3,2;3,2,4,4,4,3,4,3,2,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,4,2,3,4,4,4,4,3,4,4,4,4,3,2;3,1,1,1,1,1,2,3,2,1,2,1,1,2,3,2,1,1,1,1,2,1,2,1,1,2,3,2,1,1,1,1,2,1,1,1,2,1,3,2;3,2,4,4,2,4,2,3,2,3,2,3,2,4,3,2,3,4,4,2,4,3,2,3,2,4,3,2,3,4,4,2,4,3,2,4,4,3,4,2;3,1,2,3,2,3,2,3,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,3,2,1,3,2,1,1,3,1,2,3,1,1,1,1,3,2;3,2,4,3,4,3,2,3,2,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,3,4,1,3,2,4,4,4,3,4,2,4,4,4,2;3,1,1,1,2,3,2,3,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,1,3,2,4,1,1,1,2,1,3,1,1,2,3,2;3,2,4,4,4,3,4,3,4,3,4,4,4,4,4,4,3,4,4,4,4,3,4,4,4,4,4,4,3,4,4,4,4,3,4,4,4,4,3,2;3,2,1,2,1,1,1,2,1,2,1,1,1,2,1,2,1,1,1,2,1,2,1,1,1,2,1,2,1,1,1,2,1,2,1,1,1,2,3,2;3,2,3,2,3,4,4,2,3,2,3,4,4,2,3,2,3,4,4,2,3,2,3,4,4,2,3,2,3,4,4,2,3,2,3,4,4,2,3,2;3,1,3,1,1,1,3,1,3,1,1,1,3,1,3,1,1,1,3,1,3,1,1,1,3,1,3,1,1,1,3,1,3,1,1,1,3,1,3,2;3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4];

codes = [2,4,4,4,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,1,1,2,3,2,4,4,2,4,2,4,2,4,2,4,2,4;2,4,3,4,2,4,3,1,2,3,4,3,4,3,4,3,4,3,4,3;1,2,1,3,1,2,3,2,4,1,1,1,1,1,1,1,1,2,1,3;2,4,3,4,2,4,3,1,2,3,4,4,2,4,4,4,2,4,3,4;1,2,1,3,1,2,3,2,4,1,1,3,1,2,1,3,1,2,1,3;2,4,3,4,2,4,3,1,2,3,4,4,2,4,3,4,2,4,3,4;1,2,1,3,1,2,3,2,4,1,1,3,1,2,1,3,1,2,1,3;2,4,3,4,2,4,3,1,2,3,4,4,2,4,3,4,2,4,3,4;1,2,1,3,1,2,3,2,4,1,1,3,1,2,1,3,1,2,1,3;2,4,3,4,2,4,3,1,2,3,4,4,4,4,3,4,2,4,3,4;1,2,1,3,1,2,3,2,4,1,2,1,2,1,2,3,1,2,1,3;2,4,3,4,2,4,3,1,1,3,1,3,1,3,1,3,2,4,3,4;1,2,1,3,1,2,3,4,2,4,2,4,2,4,2,4,1,2,1,3;2,4,3,4,2,4,0,3,4,3,4,3,4,3,4,3,4,4,3,4;1,2,1,3,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,3;2,4,3,4,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3;1,2,1,3,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4;2,4,3,4,4,3,4,3,4,3,4,3,4,3,4,3,4,3,4,3;2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,3;1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3];

codes = [1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,1,1,2;3,2,4,4,2,4,4,4,2,1,1,1,1,1,1,1,2,3,4,2;3,1,2,3,1,2,0,3,2,3,2,4,4,4,4,4,2,1,3,2;3,2,4,3,2,4,1,3,2,3,2,1,1,1,1,3,2,3,4,2;3,1,2,3,1,2,3,4,2,3,2,3,4,4,4,4,4,1,3,2;3,2,4,3,4,4,1,3,2,3,2,1,2,1,2,1,2,3,4,2;3,1,1,1,1,2,3,4,2,3,2,3,1,3,1,3,1,1,3,2;3,2,4,4,2,4,1,3,2,3,2,3,4,4,4,4,4,4,4,2;3,1,2,3,1,2,3,4,4,3,1,1,1,1,1,1,1,1,3,2;3,2,4,3,2,4,1,1,2,3,4,2,4,2,4,4,4,4,4,2;3,1,2,3,1,2,3,2,4,0,3,2,3,1,1,1,1,2,3,2;3,2,4,3,4,4,3,2,1,2,3,4,3,2,4,4,4,2,3,2;3,1,1,1,1,2,3,1,3,1,1,1,3,1,1,2,3,2,3,2;3,2,4,4,2,4,3,4,4,4,4,4,4,4,4,4,3,4,3,2;3,1,2,3,1,2,1,1,1,2,1,1,1,1,2,1,1,2,3,2;3,2,4,3,2,4,3,2,4,4,3,3,2,4,4,3,2,4,3,2;3,1,2,3,1,2,3,1,1,2,3,3,1,1,2,3,2,1,3,2;3,2,4,3,4,4,3,2,4,4,3,3,2,4,4,3,2,3,2,4;3,1,1,1,1,1,3,1,1,1,3,3,1,1,1,3,1,3,1,2;3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4];
%% 10by10 1
codes = [1,1,1,2,1,1,1,2,1,2;3,2,4,2,3,2,4,2,3,2;3,2,3,2,3,2,3,1,3,2;3,2,3,2,3,4,3,4,2,4;3,2,3,1,1,1,1,3,1,2;3,2,3,2,4,4,4,2,4,2;3,2,3,1,1,2,3,2,3,2;3,2,3,2,4,2,3,2,3,2;3,2,3,2,3,2,3,2,3,2;3,4,3,4,3,4,3,4,3,4];
%%  8by8
codes = [1,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,2;3,2,4,4,4,4,4,4,4,4;3,1,1,1,1,1,1,1,1,2;3,4,4,4,4,4,4,4,4,4;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0];

%%  8by8
codes = [1,1,1,1,1,2,0,0,0,0;3,2,4,4,4,4,0,0,0,0;3,1,1,1,1,2,0,0,0,0;3,2,4,4,4,4,0,0,0,0;3,1,1,1,1,2,0,0,0,0;3,4,4,4,4,4,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0];

%%  8by8
codes = [1,1,1,1,1,2,0,0,0,0;3,0,0,0,2,4,0,0,0,0;3,0,0,0,1,2,0,0,0,0;3,0,0,0,2,4,0,0,0,0;3,0,0,0,1,2,0,0,0,0;3,4,4,4,4,4,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0];

%%  8by8
codes = [1,1,1,1,1,2,0,0,0,0;3,0,2,4,4,4,0,0,0,0;3,0,1,1,1,2,0,0,0,0;3,0,2,4,4,4,0,0,0,0;3,0,1,1,1,2,0,0,0,0;3,4,4,4,4,4,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0];

%%  8by8
codes = [1,1,1,1,1,1,1,1,1,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,0,0,0,0,0,0,0,0,2;3,4,4,4,4,4,4,4,4,4];

%%  8by8 circle
codes = [1,2,0,0,0,0,0,0,0,0;3,1,1,1,1,1,1,1,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,0,0,0,0,0,0,0,2,0;3,4,4,4,4,4,4,4,4,0;0,0,0,0,0,0,0,0,0,0];

%%  14by14 circle (10 by 10 core)
codes = [1,1,2,0,0,0,1,2,0,0,0,0,0,0;3,0,2,0,0,0,3,2,0,0,0,0,0,0;3,0,1,1,1,1,3,1,1,1,1,1,1,2;3,4,4,0,0,0,0,0,0,2,4,4,4,4;0,0,3,0,0,0,0,0,0,1,1,1,1,2;1,1,3,0,0,0,0,0,0,0,0,2,4,4;3,4,4,4,0,0,0,0,0,0,0,1,2,0;0,0,1,3,0,0,0,0,0,0,0,2,4,0;0,0,3,0,0,0,0,0,0,0,0,2,0,0;0,0,3,2,4,2,4,0,0,2,4,2,0,0;1,1,3,2,3,2,3,0,0,2,3,2,0,0;3,4,4,4,3,2,3,2,4,2,3,2,0,0;0,0,0,0,3,2,3,2,3,2,3,2,0,0;0,0,0,0,3,4,3,4,3,4,3,4,0,0];

%% 14by14 circle (10 by 10 core)
codes = [1,1,2,0,0,0,1,2,0,0,0,0,0,0;3,0,2,0,0,0,3,2,0,0,0,1,2,0;3,0,1,1,1,1,3,1,1,1,1,3,2,0;3,4,4,0,0,0,0,0,0,2,4,4,4,0;0,0,3,4,4,0,0,0,0,1,1,1,1,2;0,0,1,1,3,0,0,0,0,0,0,2,4,4;0,0,3,4,4,0,0,0,0,0,0,1,2,0;0,1,1,1,3,0,0,0,0,0,0,2,4,0;0,3,4,0,0,0,0,0,0,0,0,2,0,0;0,0,3,2,4,2,4,0,0,2,4,2,0,0;0,1,3,2,3,2,3,0,0,2,3,2,0,0;0,3,2,4,3,2,3,2,4,2,3,2,0,0;0,3,4,0,3,2,3,2,3,2,3,2,0,0;0,0,0,0,3,4,3,4,3,4,3,4,0,0];

%% 14by14 circle (10 by 10 core)
codes = [0,0,1,2,0,0,0,0,1,1,1,1,1,2;0,0,3,2,0,0,1,2,3,4,4,2,4,4;0,0,3,2,1,1,3,2,1,2,3,2,0,0;1,1,3,1,3,0,0,2,3,1,3,1,1,2;3,4,4,0,0,0,0,1,3,0,0,2,4,4;1,1,3,0,0,0,0,0,0,0,0,1,1,2;3,4,4,0,0,0,0,0,0,0,0,2,4,4;0,0,3,4,4,0,0,0,0,0,0,1,1,2;0,1,1,1,3,0,0,0,0,0,0,2,4,4;0,3,4,4,2,4,0,0,0,0,0,1,1,2;1,1,1,3,2,3,2,4,0,0,0,2,4,4;3,4,4,4,2,3,2,3,2,4,4,2,0,0;0,0,0,3,2,3,2,3,2,0,3,2,0,0;0,0,0,3,4,3,4,3,4,0,3,4,0,0];

%%
[M, N] = size(codes);
dx = zeros(M, N);
dy = zeros(M, N);
Amp = zeros(M, N);
Phase = zeros(M, N);

for ii = 1: N
    for jj = 1:M
        
        switch codes(jj, ii)
            case 1
                dx(jj, ii) = 1;
                Amp(jj, ii) = 1;
            case 2 
                dy(jj, ii) = -1;
                Amp(jj, ii) = 1;
            case 3
                dy(jj, ii) = 1;
                Amp(jj, ii) = 1;
            case 4
                dx(jj, ii) = -1;
                Amp(jj, ii) = 1;
        end
        
    end
end


% imwrite(A, 'letterA3_21by20.png')
% imwrite(A40, 'letterA3_40by40.png')
% imwrite(B, 'letterB3_21by20.png')
% imwrite(C, 'letterC3_21by20.png')

%% Generation of one Euler Travel
CurrentPhase = 0;
indX = 1;
indY = 14;
CoordCollec{M * N} = 0;
[coordX, coordY] = meshgrid(1:N, 1:M);

for ii = 1:M * N
    
    CoordCollec{ii} = [indX, indY];
    temptY = indY + dx(indX, indY);
    temptX = indX - dy(indX, indY);
    indY = temptY;
    indX = temptX;
    
end


for ii = 1:M * N
    
    indX = CoordCollec{ii}(1);
    indY = CoordCollec{ii}(2);
    Phase(indX, indY) = CurrentPhase; 
    CurrentPhase = CurrentPhase + 2*pi/3;
    if (CurrentPhase > pi)
        CurrentPhase = CurrentPhase - 2*pi;
    end
    
end


figure
quiver(coordX, flipud(coordY), dx, dy);
set(gcf,  'Position', [00, 00, 350, 300])


figure
imagesc(Phase, [-pi, pi])
colorbar
set(gcf,  'Position', [00, 00, 350, 300])

save('Phase.mat','Phase')
% 
% Amp = zeros(M, N);
% Amp(5, 5) = 1;
% Amp(5, 7) = 1;
figure
imagesc(abs(Amp), [0 1.1]);

nearField = abs(Amp) .* (exp(1i * Phase));
Angular_Spectrum = (fft2(fftshift(nearField))); %Near Field
figure
imagesc(abs(Angular_Spectrum).^2);
set(gcf,  'Position', [00, 00, 350, 300])

set(gca,  'FontSize', 10)% Font Size
colormap jet
colorbar
title('Recovered Far Field Image')
